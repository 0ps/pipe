const version="1508392271576",staticServePath="https://static.hacpai.com";self.addEventListener("install",e=>{e.waitUntil(caches.open("hacpai-static-"+version).then(e=>e.addAll([".",`${staticServePath}/js/symbol-defs.min.js?${version}`,`${staticServePath}/js/lib/compress/libs.min.js?${version}`,`${staticServePath}/js/common.min.js?${version}`,`${staticServePath}/js/lib/compress/article-libs.min.js?${version}`,`${staticServePath}/js/m-article.min.js?${version}`,`${staticServePath}/js/settings.min.js?${version}`,`${staticServePath}/js/article.min.js?${version}`,`${staticServePath}/js/channel.min.js?${version}`,`${staticServePath}/css/mobile-base.css?${version}`,`${staticServePath}/css/responsive.css?${version}`,`${staticServePath}/css/base.css?${version}`,`${staticServePath}/css/index.css?${version}`,`${staticServePath}/js/lib/highlight.js-9.6.0/styles/github.css`,`${staticServePath}/js/lib/editor/codemirror.min.css`]).then(()=>self.skipWaiting())))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(function(e){return Promise.all(e.map(function(e){if("hacpai-html"!==e&&"hacpai-avatar-emoji"!==e&&e!=="hacpai-static-"+version)return caches.delete(e)}))}))}),self.addEventListener("fetch",e=>{0===e.request.headers.get("accept").indexOf("text/html")?e.respondWith(fetch(e.request).then(function(t){return caches.open("hacpai-html").then(function(s){return s.put(e.request,t.clone()),t})}).catch(function(){return caches.match(e.request)})):e.respondWith(caches.match(e.request).then(t=>t||fetch(e.request).then(function(t){return e.request.url.indexOf("//img.hacpai.com/avatar/")>-1||e.request.url.indexOf("//static.hacpai.com/emoji/graphics/")>-1||e.request.url.indexOf("//static.hacpai.com/images/emotions/")>-1?caches.open("hacpai-avatar-emoji").then(function(s){return s.put(e.request,t.clone()),t}):t}).catch(function(){console.log(`fetch ${e.request.url} error`)})))});